
let urlJsonEnviar,  urlPoUp,    match;

chrome.tabs.query({active: true, currentWindow: true}, function(tabs) {
        const activeTab   =  tabs[0]   
        chrome.tabs.sendMessage(tabs[0].id, {greeting: "hello"}, function(response) {
            urlPoUp =   response;
            urlPoUp =   urlPoUp.farewell
            console.log("Lista de URL's:");
            // console.log(urlPoUp);// BIEN
            
            console.log(urlPoUp);// BIEN

            //CONEXIÃ“N AL
            fetch("http://127.0.0.1:8000/urlPost/",    {

                method: "POST",
                body: JSON.stringify(urlPoUp),
            })
            .then(
                function(response)  {
                    console.log("1 promise")
                    console.log(response)
                    return  response.json()
                }
            )
            .then(
                function(context)  {
                    console.log("2 promise")
                    context =   JSON.parse(context);
                    console.log(typeof(context));
                    console.log(context);
                    chrome.tabs.sendMessage(tabs[0].id, {greeting: ["hello_2",  context]}, function(response) {
                        respuestaFinal    =   response;
                        console.log("Estado del flujo:");
                        console.log(respuestaFinal);
                    });
                }
            )
        })
});

